[flake8]
ignore = E203, E266, E501, W503
max-line-length = 88
max-complexity = 18
select = B, C, E, F, W, T4
exclude = .tox, .eggs, .github, build, dist

[tox]
isolated_build = true
envlist = fmt-check, lint, docs, py{38,39,310}

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: fmt-check, lint, docs, py310

[testenv]
allowlist_externals = poetry
commands_pre = 
    poetry install --no-root --sync
commands =
    poetry run pytest tests/ --import-mode importlib --cov -vv

[testenv:fmt-check]
skip_install = true
deps =
    black
    isort
commands =
    isort --diff .
    black --check .

[testenv:lint]
skip_install = true
deps =
    flake8
commands =
    flake8 . --count --show-source --statistics

[testenv:docs]
skip_install = true
allowlist_externals = poetry
commands_pre = 
    poetry install
commands = 
    poetry run sphinx-build -E -b html docs dist/docs
    poetry run sphinx-build -b linkcheck docs dist/docs
